{% extends 'base.html' %}

{% block title %}{{ object.title }}{% endblock %}

{% block content %}
<ul class="nav nav-pills pt-2 pb-2 d-flex">
    <li class="col-2">
         <a href="{% url 'contractor_contracts_list' object.id %}" class="btn btn-primary col-11">Договоры</a>
    </li>

    <li class="col-2">
        <a href="{% url 'contractor_orders_list' object.id %}" class="btn btn-primary col-11">Заказы</a>
    </li>

    <li class="col-2">
        <a href="{% url 'contact_persons_list' object.id %}" class="btn btn-primary col-11">Контактные лица</a>
    </li>
</ul>

<h1>Информация о контрагенте</h1>
<div class="card col-9">
     <ul class="list-group list-group-horizontal">
         <li class="list-group-item">
             <a href="{% url 'contractor_edit' object.id %}" class="btn btn-primary">Редактировать</a>
         </li>
        {% if contractor.to_delete %}
         <li class="list-group-item">
            <a href="{% url 'contractor_to_delete' object.id %}" class="btn btn-danger">Снять пометку на удаление</a>
         </li>
        {% else %}
         <li class="list-group-item">
            <a href="{% url 'contractor_to_delete' object.id %}" class="btn btn-danger">Пометить на удаление</a>
         </li>
        {% endif %}
     </ul>
    <div class="card-body d-flex justify-content-between">
        <h5 class="card-title">{{ object.title }}</h5>
        {% if contractor.to_delete %}
        <p class="text-danger fw-bold">Помечен на удаление</p>
        {% endif %}
        <p class="text-success">{{ object.status }}</p>
    </div>
    <ul class="list-group list-group-flush">
        <li class="list-group-item">Должность: {{ object.position }}</li>
        <li class="list-group-item">Обращение: {{ object.appeal }}</li>
        <li class="list-group-item">Имя: {{ object.name }}</li>
        <li class="list-group-item">Отчество\Второе имя: {{ object.second_name }}</li>
        <li class="list-group-item">Фамилия: {{ object.last_name }}</li>
        <li class="list-group-item">Страна: {{ object.country }}</li>
        <li class="list-group-item">Реквизиты: {{ object.requisites }}</li>
    </ul>
</div>

{% if contacts %}
<h4 class="text-center mt-4 border-top border-bottom pb-1">Контактные данные</h4>
<table class="table" id="contact-form-wrapper">
    <thead>
    <tr>
        <th scope="col">Тип контакта</th>
        <th scope="col">Контактные данные</th>
        <th scope="col">Имя контакта</th>
    </tr>
    </thead>
    <tbody>
    {% for contact in contacts %}
    <tr class="contact-form-container">
        <td>{{ contact.type_of_contact }}</td>
        <td>{{ contact.contact }}</td>
        <td>{{ contact.contact_name }}</td>
    </tr>
    {% endfor %}

    </tbody>
</table>
{% endif %}

{% if comments %}
<h2>Комментарии к контрагенту</h2>
{% for comment in comments %}
<div class="row">
    <div class="col-5">
        <div class="card mb-2">
            <div class="card-body">
                <h5 class="card-title">{{ comment.user }}</h5>
            </div>
            <ul class="list-group list-group-flush">
                <li class="list-group-item">{{ comment.text }}</li>
                <li class="list-group-item">Дата создания: {{ comment.created }}</li>
            </ul>
        </div>
    </div>
</div>
{% endfor %}
{% endif %}

<form class="card col-4 mb-2" name="comment-form" method="post" action="{% url 'contractor_detail' object.id %}">
    <div class="card-body">
        <h5 class="card-title">Оставить комментарий</h5>
    </div>
    {% csrf_token %}
    <ul class="list-group list-group-flush">
        {{ comment_form.text.errors }}
        <li class="list-group-item">{{ comment_form.text }}</li>
    </ul>
    <div class="card-body">
        <input class="btn btn-primary col-3" type="submit" value="Добавить">
    </div>
</form>
{% endblock %}